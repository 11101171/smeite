@(user:Option[models.user.User],author:models.user.User,theme:models.theme.Theme,style:models.theme.ThemeStyle,page:Page[(models.user.User,models.theme.ThemeDiscuss)],users:Page[models.user.User])
@views.html.template(
user,
title = theme.name+" _ 主题讨论吧 _ 食美特，爱美食爱生活",
keywords =  theme.tags.get,
description = theme.intro.get
)(css="/assets/css/template/theme.detail.css") {
<div class="container">
<style>
    body{
        background-color:@style.pageBgColor;
        background-image:url(@style.pageBgImage) ;
        background-repeat:@style.pageBgRepeat;
        background-position:@style.pageBgPosition;
        background-attachment:@style.pageBgAttachment;
    }
</style>
<div class="nav-wrap clearfix">
    @if(!user.isEmpty && user.get.id.get == author.id.get){
    <div class="user-tool">
        <div class="user-tool-nav clearfix">
            <div class="fl">
                <label>添加宝贝：<input type="text" class="base-input" placeholder="http://" id="J_UserProductUrl" value=""/></label>
                <a id="J_UserAddProduct" class="bbl-btn">确定</a>
                <i class="i-split"></i>
                <a href="@controllers.routes.Themes.edit(theme.id.get)" rel="nofollow" class="bgr-btn">编辑</a>
                <a id="J_UserThemeStyleOpenBtn" class="bgr-btn">美化</a>
            </div>
            <div class="fr">
                <a class="del" id="J_UserThemeDel" data-type="my" data-themeid="@theme.id.get">删除主题</a>
            </div>
        </div>
        <div class="user-theme-style clearfix" id="J_UserThemeStyle">

            <dl class="page-style">
                <dd>
                    <strong>页面背景</strong>
                    <label class="color"><span>底色：</span><a data-colorval="#F9F9EF" id="J_PageBgColor"><i
                            style="background-color:#F9F9EF"></i></a></label>
                    <label class="theme-pic"><span>图片：</span>
                        <button class="sgr-btn" id="J_PagePicBtn" data-src="">上传图片</button>
                        <div class="upload-con" id="J_PagePicUploadCon">
                            <p>支持JPG/PNG图片，文件需小于2M</p>

                            <form id="J_PagePicUploadForm" target="pagePicUploadTarget" action="@controllers.routes.Upload.uploadThemeStylePic"
                                  method="post" enctype="multipart/form-data">
                                <button class="bbl-btn">选择文件</button>
                                <input type="file" name="filedata" class="file-input" id="J_PageFileInput"
                                       onchange="window.submitPic(this, 'page')" size="20" hidefocus="true">
                                <input type="hidden" name="picType" value="themeBg">
                            </form>
                            <iframe name="pagePicUploadTarget" id="pagePicUploadTarget" width="0" height="0"
                                    style="display:none" frameborder="0" allowtransparent="yes" scrolling="no"></iframe>
                        </div>
                    </label>
                    <label><input type="checkbox" value="1" id="J_PageBgRepeat"/>平铺</label>
                    <label><input type="checkbox" value="1" id="J_PageBgAttachment"/>锁定</label>
                    <label><select id="J_PageBgPosition" data-val="left">
                        <option value="center">居中</option>
                        <option value="left">居左</option>
                        <option value="right">居右</option>
                    </select></label>
                    <a class="del" id="J_PagePhotoDel">移除图片</a>
                </dd>
            </dl>
            <div class="oper">
                <a class="bbl-btn" id="J_ThemeStyleSave">保存设置</a>
                <a class="bgr-btn" id="J_UserThemeStyleCloseBtn">关闭</a>
            </div>
        </div>
    </div>
    }
    <div class="brand-nav">
        <ul class="nav-bar clearfix">
            <li class="h on">
                <div class="nav-item clearfix">
                    <h2>
                        <a href="@controllers.routes.Themes.view(theme.id.get)" data-val="0">@theme.name</a>
                    </h2>
                    @if(!user.isEmpty && user.get.id.get == author.id.get){
                    <a href="javascript:;" class="follow  mt5 mr10"  title="我的主题">我的主题</a>
                    }else{
                    <a rel="followTheme" href="javascript:;" class="follow  mt5 mr10" data-type="1" data-themeid="@theme.id.get" title="关注">+ 关注</a>
                    }
                    <a class="btn-share mt5" href="javascript:;" data-sharetxt="我在食美特发现了这个主题，我很喜欢，分享给大家 :@theme.name  " data-sharelink="@controllers.routes.Themes.view(theme.id.get)" data-sharepic="@theme.pic" title="分享">分享</a>

                </div>
            </li>
            <li>
                <div class="nav-item">
                    <a  href="@controllers.routes.Themes.view(theme.id.get)" title="宝贝"><em>@theme.goodsNum</em><br>宝贝</a>
                </div>
            </li>
            <li>
                <div class="nav-item">
                    <a class="trait" href="@controllers.routes.Themes.board(theme.id.get,1)">@theme.replyNum<br>讨论</a>
                </div>
            </li>
            <li>
                <div class="nav-item">
                    <a href="@controllers.routes.Themes.likes(theme.id.get,1)"><em id="J_LikeCount">@theme.loveNum</em><br>关注</a>
                </div>
            </li>
            <i></i>
        </ul>
			<span class="pos-l-txt gc6">返回：
    	    	        <a href='@controllers.routes.Pages.miss'>美食街</a>
    	    	        <span class="ml5 mr5">/</span>
                        <a href='@controllers.routes.Pages.gallery(theme.cid,"new",1)'>@models.Cate(theme.cid)</a>

                        </span>
    </div>

</div>
<div class="main clearfix">
<div class="allcomment colmain715 box-shadow" id="J_AllComment">
    <div class="pl20 pr20">
        <h3>
            <a href="@controllers.routes.Themes.view(theme.id.get)">@theme.name</a>&nbsp;&gt;&nbsp;讨论板
            <a id="J_JoinCmt" class="fr" href="javascript:;">参加讨论</a>
        </h3>
        <ul class="forum-post" id="J_ForumPost">

            @for((u,discuss)<-page.items){
            @if(discuss.checkState==1 || (!user.isEmpty && user.get.id.get==discuss.uid)){
            <li data-cmtid="@discuss.id">
                <a class="img" href="@controllers.users.routes.Users.home(u.id.get)" target="_blank"><img src="@u.pic" width="50px" height="50px"></a>
								<span class="info">
                                    <a class="J_UserNick g-daren" href="@controllers.users.routes.Users.home(u.id.get)" target="_blank">
                                        <em>@u.name</em>
                                        @if(u.daren==1){
                                        <i class="i-daren">达人</i>
                                        }
                                    </a>
                                    <span class="time">&nbsp;/&nbsp;  @discuss.addTime</span>
								</span>
                <div class="post">
                    <p class="J_PostCon wbbw">@discuss.content</p>
                </div>
              <!--  <span class="post-floor">＃3</span>-->
                <p class="oper" data-cmtid="@discuss.id">
                    <a class="J_PostCmtReply">回复</a>
                </p>
            </li>
            }
            }



        </ul>
        <div class="clearfix pt20 pb10">

                <div class="pagin clearfix fr">

                    @page.prev.map { page =>
                        <a class="prev" href="@controllers.routes.Themes.board(theme.id.get,page)">上一页</a>
                    }
                    @for(num <-page.nums){
                    @if(num==page.currentPage){
                    <span class="current">@num</span>
                    }else {
                    <a href="@controllers.routes.Themes.board(theme.id.get,num)">@num</a>
                    }
                    }
                    @page.next.map { page =>
                        <a class="next" href="@controllers.routes.Themes.board(theme.id.get,page)">下一页</a>
                    }
                </div>

        </div>
        <form class="form-cmt" id="J_PostCmtArea" action="#" method="post">
            <input type="hidden" name="themeId" id="J_ThemeId" value="@theme.id.get">
            <ul class="clearfix">
                @if(!user.isEmpty){
                <li class="form-nick g-daren">
                    <span class="userPhoto">
                        <img width="20" height="20" src="@user.get.pic" title="@user.get.name" alt="@user.get.name">
                    </span>@user.get.name
                </li>
                }
                <li id="J_PostCmtSegment" class="post-reply"></li>
                <li><textarea class="b-textarea" id="J_Content" name="content" placeholder="说两句~~" style="background-color: rgb(255, 255, 255); "></textarea></li>
                <li>
                    <input type="button" class="bbl-btn" id="J_CmtPublishBtn" value="发表">
                    <div id="J_FaceBtn">
                        <a class="faceBtn" href="javascript:;" unselectable="on" facebtn="faceBtn">表情</a>
                    </div>
                </li>
            </ul>
        </form>
    </div>
</div>
<div class="side colaside230">

    <div class="author box-shadow">
        <div class="message">
            <strong>主题寄语</strong>
            <span class="fr"><a href="@controllers.routes.Themes.edit(theme.id.get)" rel="nofollow">编辑</a></span>

            <p>@theme.intro</p>
        </div>

        <div class="info">
            <div class="pic">
                <a href="@controllers.users.routes.Users.home(author.id.get)">
                    <img src="@author.pic" width="50"  height="50" alt="@author.name" title="@author.name">
                </a>
            </div>
            <div class="pic-text">
                <div class="txt-title clearfix">
                    <a href="@controllers.users.routes.Users.home(author.id.get)" target="_blank"><em class="ofh inlineblock">@author.name</em></a> &nbsp;创建
                </div>
                <p>集分宝(@(author.credits))&nbsp;/&nbsp;食豆(@(author.shiDou))</p>
            </div>
        </div>
    </div>
    @if(!theme.tags.isEmpty){
    <div class="tags box-shadow  plr10">
        <div class="title">相关标签</div>
        <ul class="clearfix">
            @for(tag<-theme.tags.get.split(",")){
            <li><a href='@controllers.routes.Pages.find("tag",tag,1)' target="_blank">@tag</a></li>
            }

        </ul>
    </div>
    }
    <!-- 喜欢的人 -->
    <div class="themelikes box-shadow plr15">
        <div class="title"><a href="@controllers.routes.Themes.likes(theme.id.get,1)" class="all-follows">全部&gt;</a>关注这个主题的人</div>
        <ul class="clearfix">
            @for((user,i)<-users.items.view.zipWithIndex){
            <li @if((i+1)%4==0){ class="last" }>
                <a href="@controllers.users.routes.Users.home(user.id.get)" title="@user.name" target="_blank">
                    <img src="@user.pic" width="46" height="46" alt="@user.name" title="@user.name">
                </a>
            </li>
            }
        </ul>
    </div>

</div>
</div>

<div class="theme_share clearfix box-shadow">
    <span class="theme_tip">看完啦？别忘了关注一下~</span>
    <a rel="followTheme" class="ifollow" data-type="1" data-themeid="@theme.id.get" href="javascript:;" title="关注">+ 关注</a>
    <a class="icomment" href="@controllers.routes.Themes.board(theme.id.get,1)#cmtlist" title="讨论">讨论</a>

    <div class="share fr">
        <span class="fl l20">叫上好友一起来：</span>
        <a class="s-sina"
           href="javascript:void((function(){var title=encodeURIComponent('《@theme.name》－ 食美特，发现生活之美');var link=window.location.href;var pic='';window.open('http://service.t.sina.com.cn/share/share.php?appkey=1464940004&title='+title+'&pic='+pic+'&url='+link);})())"
           alt="分享到新浪微博"></a>
        <a class="s-qzone"
           href="javascript:void((function(){var title=encodeURIComponent('《@theme.name》－ 食美特，发现生活之美');var link=window.location.href;window.open('http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url='+link);})())"
           alt="分享到QQ空间"></a>
        <a class="s-tencent"
           href="javascript:void((function(){var title=encodeURIComponent('《@theme.name》－ 食美特，发现生活之美');var link=window.location.href;var pic='';window.open('http://v.t.qq.com/share/share.php?appkey=100344510&url='+link+'&title='+title+'&pic=&site='+link);})())"
           alt="分享到腾讯微博"></a>
        <a class="s-douban"
           href="javascript:void((function(){var title=encodeURIComponent('《@theme.name》－ 食美特，发现生活之美');var link=window.location.href;window.open('http://www.douban.com/recommend/?url='+link+'&title='+title);})())"
           alt="分享到豆瓣"></a>
        <a class="s-renren"
           href="javascript:void((function(){var title=encodeURIComponent('《@theme.name》－ 食美特，发现生活之美');var link=window.location.href;window.open('http://share.renren.com/share/buttonshare.do?link='+link+'&title='+title);})())"
           alt="分享到人人网"></a>
        <a class="s-163"
           href="javascript:void((function(){var title=encodeURIComponent('《@theme.name》－ 食美特，发现生活之美');var link=window.location.href;var pic='';window.open('http://t.163.com/article/user/checkLogin.do?link='+link+'&source=食美特&info='+title+link+'&images='+pic+'&togImg=true');})());"
           alt="分享到网易微博"></a>
    </div>
</div>

 </div>

        }{
<script type="text/javascript">

    seajs.use('app/init', function (init) {
        init.load("app/theme/theme.detail,app/theme/theme.board,app/theme/theme.discuss,app/theme/theme.favor,app/smeite.simpleEditor");
    });
</script>
}